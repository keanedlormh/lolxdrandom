<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zombie Shooter Multijugador</title>


    <!-- FUENTES DE LA ESTÉTICA "APOCALIPSIS" -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">


    <!-- v1.5: ESTILOS SEPARADOS -->
    <link rel="stylesheet" href="css/style.css">


</head>
<body>


    <!-- Pantalla de Juego -->
    <div id="gameScreen">
        <canvas id="gameCanvas"></canvas>
    </div>


    <!-- Menú Principal -->
    <div id="menuScreen" class="menu-container">
        <h2>Zombie Shooter</h2>
        <input type="text" id="playerNameInput" placeholder="INTRODUCE TU NOMBRE" maxlength="15" value="Player1">
        <hr>
        <button id="createGameButton" class="btn btn-primary btn-block"><span>Crear Partida</span></button>
        <button id="browseGamesButton" class="btn btn-primary btn-block"><span>Buscar Partidas</span></button>
        <hr>
        <input type="text" id="roomIdInput" placeholder="UNIRSE POR ID (EJ: ABCD)" maxlength="4" style="text-transform: uppercase;">
        <button id="joinGameButton" class="btn btn-primary btn-block"><span>Unirse por ID</span></button>
        <hr>
        <button id="settingsButton" class="btn btn-secondary btn-block"><span>⚙️ Configuración</span></button>
    </div>


    <!-- Menú de Configuración -->
    <div id="settingsScreen" class="menu-container" style="display: none;">
        <h2>Configuración</h2> 
        <div class="preset-buttons">
            <button onclick="applyPreset('easy')" class="btn btn-primary"><span>Fácil</span></button>
            <button onclick="applyPreset('normal')" class="btn btn-secondary"><span>Normal</span></button>
            <button onclick="applyPreset('hard')" class="btn btn-danger"><span>Difícil</span></button>
        </div>


        <!-- CONFIGURACIÓN LOCAL -->
        <div class="settings-group">
            <h3>Configuración Local</h3>
            <div class="setting-item">
                <label>Método de Control:</label>
                <select id="setting_controlType">
                    <option value="auto">Automático</option>
                    <option value="touch">Joystick Táctil</option>
                    <option value="keyboard">Teclado/Ratón</option>
                </select>
            </div>
        </div>


        <hr>


        <!-- CONFIGURACIÓN DE PARTIDA -->
        <h3 style="text-align:center; text-transform:uppercase; letter-spacing: 2px; margin-bottom: 0;">Configuración de Partida</h3>
        <p style="text-align:center; font-size: 0.9em; opacity: 0.7; margin-top: 5px; margin-bottom: 10px;">(Solo aplica si eres el Host)</p>


        <!-- Grupo: Jugador y Combate -->
        <div class="settings-group">
            <h4>Jugador y Combate</h4>
            
            <div class="setting-item slider-group">
                <label>Vida Máxima:</label>
                <span id="setting_playerHealth_value" class="slider-value">100</span>
            </div>
            <input type="range" id="setting_playerHealth" min="50" max="300" value="100" class="slider-control">

            <div class="setting-item slider-group">
                <label>Velocidad:</label>
                <span id="setting_playerSpeed_value" class="slider-value">6</span>
            </div>
            <input type="range" id="setting_playerSpeed" min="3" max="12" value="6" step="0.5" class="slider-control">

            <div class="setting-item slider-group">
                <label>Cooldown Disparo:</label>
                <span id="setting_shootCooldown_value" class="slider-value">150 ms</span>
            </div>
            <input type="range" id="setting_shootCooldown" min="50" max="500" value="150" step="10" class="slider-control">

            <hr class="subtle">

            <div class="setting-item slider-group">
                <label>Daño de Bala:</label>
                <span id="setting_bulletDamage_value" class="slider-value">10</span>
            </div>
            <input type="range" id="setting_bulletDamage" min="5" max="50" value="10" class="slider-control">

            <div class="setting-item slider-group">
                <label>Velocidad de Bala:</label>
                <span id="setting_bulletSpeed_value" class="slider-value">25</span>
            </div>
            <input type="range" id="setting_bulletSpeed" min="10" max="40" value="25" class="slider-control">
        </div>


        <!-- Grupo: Opciones del Mapa -->
        <div class="settings-group">
            <h4>Opciones del Mapa</h4>
            <div class="setting-item"><label>Tamaño del Mapa:</label><select id="setting_mapSize"><option value="40">Pequeño (40x40)</option><option value="60" selected>Mediano (60x60)</option><option value="80">Grande (80x80)</option></select></div>
            
            <div class="setting-item slider-group" style="margin-top: 15px;">
                <label>Número de Salas:</label>
                <span id="setting_roomCount_value" class="slider-value">6 salas</span>
            </div>
            <input type="range" id="setting_roomCount" min="3" max="12" value="6" class="slider-control">

            <div class="setting-item"><label>Ancho de Pasillos:</label><select id="setting_corridorWidth"><option value="2">Estrecho (2)</option><option value="3" selected>Medio (3)</option><option value="4">Ancho (4)</option></select></div>
        </div>


        <!-- Grupo: Enemigos (Contiene sub-grupos) -->
        <div class="settings-group">
            <h3>Enemigos</h3>


            <!-- Sub-Grupo: Aumento por Oleada -->
            <h4>Aumento por Oleada</h4>
            <div class="setting-item slider-group">
                <label>Aum. Zombies Fase 1:</label>
                <span id="waveMultiplierValue" class="slider-value">+50%</span>
            </div>
            <input type="range" id="setting_waveMultiplier_slider" min="10" max="100" value="50" step="1" class="slider-control">
            <input type="hidden" id="setting_waveMultiplier" value="1.5">


            <div class="setting-item slider-group" style="margin-top: 15px;">
                <label>Ritmo Rápido (Fase 1):</label>
                <span id="coreBurstSpawnMultiplierValue" class="slider-value">x2.5</span>
            </div>
            <input type="range" id="setting_coreBurstSpawnMultiplier_slider" min="110" max="500" value="250" step="10" class="slider-control">
            <input type="hidden" id="setting_coreBurstSpawnMultiplier" value="2.5">


            <hr class="subtle">


            <!-- Sub-Grupo: Opciones del Zombi -->
            <h4>Opciones del Zombi</h4>
            <div class="setting-item slider-group">
                <label>Vida Máxima:</label>
                <span id="setting_zombieHealth_value" class="slider-value">30</span>
            </div>
            <input type="range" id="setting_zombieHealth" min="10" max="100" value="30" class="slider-control">

            <div class="setting-item slider-group">
                <label>Velocidad:</label>
                <span id="setting_zombieSpeed_value" class="slider-value">3</span>
            </div>
            <input type="range" id="setting_zombieSpeed" min="1" max="8" value="3" step="0.5" class="slider-control">

            <div class="setting-item slider-group">
                <label>Daño de Ataque:</label>
                <span id="setting_zombieAttack_value" class="slider-value">10</span>
            </div>
            <input type="range" id="setting_zombieAttack" min="5" max="50" value="10" class="slider-control">

            <div class="setting-item slider-group">
                <label>Cooldown Ataque:</label>
                <span id="setting_zombieAttackCooldown_value" class="slider-value">1000 ms</span>
            </div>
            <input type="range" id="setting_zombieAttackCooldown" min="500" max="3000" value="1000" step="100" class="slider-control">


            <hr class="subtle">


            <!-- Sub-Grupo: Opciones del Núcleo -->
            <h4>Opciones del Núcleo</h4>
            <div class="setting-item slider-group">
                <label>Vida Base del Núcleo:</label>
                <span id="setting_coreBaseHealth_value" class="slider-value">500</span>
            </div>
            <input type="range" id="setting_coreBaseHealth" min="100" max="5000" value="500" step="50" class="slider-control">

            <!-- v1.5: NUEVO SLIDER (Aumento Vida Núcleo) -->
            <div class="setting-item slider-group">
                <label>Aum. Vida Núcleo (x Oleada):</label>
                <span id="setting_coreHealthMultiplier_value" class="slider-value">+15%</span>
            </div>
            <!-- El valor es 100-125, representa 1.00 a 1.25 (0% a 25%) -->
            <input type="range" id="setting_coreHealthMultiplier_slider" min="100" max="125" value="115" step="1" class="slider-control">
            <input type="hidden" id="setting_coreHealthMultiplier" value="1.15">
            <!-- Fin v1.5 -->

            <div class="setting-item slider-group">
                <label>Zombies Fase 1 (Oleada 1):</label>
                <span id="setting_initialZombies_value" class="slider-value">10 zombies</span>
            </div>
            <input type="range" id="setting_initialZombies" min="1" max="50" value="10" class="slider-control">

            <div class="setting-item slider-group">
                <label>Ritmo Fase 2:</label>
                <span id="setting_coreBaseSpawnRate_value" class="slider-value">5000 ms</span>
            </div>
            <input type="range" id="setting_coreBaseSpawnRate" min="1000" max="10000" value="5000" step="250" class="slider-control">
        </div>




        <hr>
        <button id="saveSettingsButton" class="btn btn-primary btn-block"><span>Guardar y Volver</span></button>
        <button id="resetSettingsButton" class="btn btn-danger btn-block"><span>Restaurar Defaults</span></button>
    </div>


    <!-- Sala de Espera -->
    <div id="lobbyScreen" class="menu-container" style="display: none;">
        <h2>Sala de Espera</h2>
        <p id="lobbyRoomId"></p>
        <h3>Jugadores:</h3>
        <ul id="lobbyPlayerList"></ul>
        <div id="hostConfigInfo" style="display: none;">
            <strong>Configuración Activa:</strong>
            <div id="configSummary" style="margin-top: 5px;"></div>
        </div>
        <hr>
        <button id="startButton" class="btn btn-primary btn-block"><span>Iniciar Partida</span></button>
        <button id="backToMenuButton" class="btn btn-danger btn-block"><span>Volver al Menú</span></button>
    </div>


    <!-- Lista de Salas -->
    <div id="roomListScreen" class="menu-container" style="display: none;">
        <h2>Salas Activas</h2>
        <div id="roomListContainer"></div>
        <div class="room-list-actions">
            <button id="refreshRoomListButton" class="btn btn-secondary" style="flex: 1;"><span>Refrescar</span></button>
            <button id="backToMenuFromRoomListButton" class="btn btn-danger" style="flex: 1;"><span>Volver</span></button>
        </div>
    </div>


    <!-- Fin de Partida -->
    <div id="gameOverScreen" class="menu-container" style="display: none;">
        <h2>GAME OVER</h2>
        <p>Puntuación Final: <span id="finalScore" style="font-weight: bold;">0</span></p>
        <p>Oleada Alcanzada: <span id="finalWave" style="font-weight: bold;">0</span></p>


        <div class="game-over-actions">
            <button id="continueGameButton" class="btn btn-primary btn-block"><span>Continuar</span></button>
            <button id="exitToMenuButton" class="btn btn-danger btn-block"><span>Salir al Menú</span></button>
        </div>
    </div>


    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script> 
    <script src="js/entities.js"></script>
    <script src="js/game.js"></script>
</body>
</html>